/** stopwatch-emitter - v0.0.4 - https://github.com/brian-frichette/Stopwatch
  * Copyright (c) 2014 Brian Frichette. All rights reserved.
  * Licensed MIT - http://opensource.org/licenses/MIT
  *
  * EventEmitter - git.io/ee
  * Oliver Caldwell
  * MIT license
  */
!function(a){var b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},Stopwatch=function(a){function Stopwatch(a){null==a&&(a="5m"),this.currentTime=0,this._stopEmitted=!1,this._running=!1,this.toQ=[],this.parseTime(a),this._setupEvents()}c(Stopwatch,a);var b=Stopwatch.prototype;return b.parseTime=function(a){if(!isNaN(a))return this.maxTime=a;a=(""+a).match(/([\d\.]+)(\w{1})/);var b=parseFloat(a[1],10),c=a[2];switch(c){case"s":b*=1;break;case"m":b*=60;break;case"h":b*=3600}this.maxTime=Math.round(b)},b._setupEvents=function(){var a=this;a.on("stop",function(){a._stopEmitted=!0,a.clear()});var b=function(){a._stopEmitted=!1,a._running&&a.clear()};a.on("start",b),a.on("pause",b),a.on("restart",b)},b.tick=function(){var a=this;if(a.currentTime>=a.maxTime)return a._stopEmitted||a.emit("stop"),void(a._running=!1);if(a._running){a.emit("tick");var b=setTimeout(function(){a.currentTime++,a.tick()},1e3);a.toQ.push(b)}},b.clear=function(){for(var a=this.toQ;a.length;)clearTimeout(a[a.length-1]),a.pop()},b.pause=function(){this._running&&(this._running=!1,this.emit("pause"))},b.stop=function(){this._running&&(this._running=!1,this.currentTime=0,this.emit("stop"))},b.restart=function(){this.currentTime=0,this.emit("restart"),this.start(!1)},b.start=function(a){null==a&&(a=!0),this._running&&a||this.currentTime>=this.maxTime||(a&&this.emit("start"),this._running=!0,this.tick())},b.getCurrentTime=function(){return this.currentTime},b.getRemainingTime=function(){return this.maxTime-this.currentTime},b.getMaxTime=function(){return this.maxTime},b.isRunning=function(){return!!this._running},Stopwatch}(EventEmitter);a.Stopwatch=Stopwatch}(this);